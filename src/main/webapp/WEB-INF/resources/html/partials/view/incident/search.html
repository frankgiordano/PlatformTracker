<div data-ng-init="init()">
	<div ng-hide="selectedIncident">

		<div>
			<h2>Search Incidents</h2>
		</div>
		<!--     
    	<button class="btn btn-primary pull-right" ng-click="refreshData()">Refresh Data</button>
		-->
		<div style="clear:both;">&nbsp;</div>
		<div class="form-group">
			<label class="control-label pull-left">Count Total:</label>
			<div class="col-sm-7 form-control-static">
				{{incidents.length}}
			</div>
		</div>

		<table st-table="displayedIncidents" st-safe-src="incidents"
			class="table table-striped table-hover table-condensed">
			<thead>
				<tr>
					<th st-sort="id">ID</th>
					<th st-sort="tag">Tag</th>
					<th st-sort="status">Status</th>
					<th st-sort="severity">Sev</th>
					<th st-sort="description">Description</th>
					<th st-sort="error">Error</th>
					<th st-sort="locus">Locus</th>
					<th st-sort="startTime" st-sort-default="reverse">Start Time</th>
					<th st-sort="endTime">End Time</th>
					<th st-sort="usersImpacted">Users Imp'ed</th>
					<th st-sort="callsReceived">Calls</th>
					<th st-sort="alertedBy">AlertedBy</th>
				</tr>
				<tr>
					<!-- 			<th colspan="2">
					<input st-search="tag" placeholder="search for tag" class="input-sm form-control" type="search" />
				</th>
-->
					<th colspan="4">
						<input st-search placeholder="global search" class="input-sm form-control" type="search" />
					</th>
				</tr>
			</thead>

			<tbody>
				<tr class="btn-link" ng-repeat="incident in displayedIncidents" ng-click="select('incident', incident)">
					<td class='DK_name'>{{incident.id}}</td>
					<td>{{incident.tag}}</td>
					<td>{{incident.status }}</td>
					<td>{{incident.severity}}</td>
					<td>
						<div my-qtip qtip-content="{{incident.description + ' ' + incident.summary}}">
							{{incident.description + " " + incident.summary | addEllipsis}}
						</div>
					</td>
					<td>{{incident.errorName}}</td>
					<td>{{incident.locus}}</td>
					<td>{{incident.startTime | dateFormat}}</td>
					<td>{{incident.endTime | dateFormat}}</td>
					<td>{{incident.usersImpacted | percentage}}</td>
					<td>{{incident.callsReceived}}</td>
					<td>{{incident.alertedBy}}</td>
				</tr>
			</tbody>

			<tfoot>
				<tr>
					<td colspan="5" class="text-center">
						<div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div>
					</td>
				</tr>
			</tfoot>
		</table>
	</div>

	<form class="form-horizontal" ng-show="selectedIncident">
		<div ng-include="'resources/html/partials/view/incident/edit.html'" ng-if="show">
			<!-- The actual modal template, just a bit o bootstrap -->
			<script type="text/ng-template" id="modal.html">
         		<div class="modal fade">
          			<div class="modal-dialog">
            			<div class="modal-content">
              				<div class="modal-header">
                				<button type="button" class="close" ng-click="close('Cancel')" data-dismiss="modal" aria-hidden="true">&times;</button>
                				<h4 class="modal-title">Deletion confirmation:</h4>
             				</div>
              				<div class="modal-body">
               					<p>Are you sure you want to delete the incident?</p>
             				</div>
              		 		<div class="modal-footer">
               			 		<button type="button" ng-click="close('No')" class="btn btn-default" data-dismiss="modal">No</button>
               			 		<button type="button" ng-click="close('Yes')" class="btn btn-primary" data-dismiss="modal">Yes</button>
              				</div>
           			 	</div>
          			</div>
        		</div>
     		</script>
		</div>
	</form>

</div>