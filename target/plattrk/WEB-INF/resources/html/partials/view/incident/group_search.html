
<div data-ng-init="init()">

	<div ng-hide="selectedGroup">

	<div>
       <h2>Search Incident Groups</h2>
	</div>
	
	<div id="messages" class="alert alert-success" data-ng-show="messages" data-ng-bind="messages"></div>
	<div id="messages" class="alert alert-danger" data-ng-show="errormessages" data-ng-bind="errormessages"></div>
<!-- 	
	<button class="btn btn-primary pull-right" ng-click="refreshData()">Refresh Data</button>
 -->	
 	
	<button class="btn btn-primary pull-right" ng-click="deleteAllGroupOrphans()">Remove Orphan Groups</button>
	
    <div style="clear:both;">&nbsp;</div>
	<div class="form-group">
             <label class="control-label pull-left">Count Total:</label>
             <div class="col-sm-7 form-control-static">
               				{{groups.length}}
             </div>
    </div>

	<div style="clear:both;">&nbsp;</div>

	  <table st-table="displayedGroups" st-safe-src="groups" class="table table-striped table-hover table-condensed">
		<thead>
			<tr>
				<th st-sort="id">ID</th>
				<th st-sort="name" st-sort-default="true">Name</th>
				<th st-sort="description">Description</th>
				<th st-sort="status">Status</th>
			</tr>
			<tr>
<!--			<th colspan="2">
					<input st-search="name" placeholder="search for Name" class="input-sm form-control" type="search" />
				</th>
-->
				<th colspan="2">
						<input st-search placeholder="global search" class="input-sm form-control" type="search"/>
				</th>
			</tr>
		</thead>
		<tbody>
	
		<tr class="btn-link" ng-repeat="group in displayedGroups" ng-click="select('group', group)">
			<td class='DK_name'>{{group.id}}</td>
			<td>{{group.name}}</td>
			<td>
                <div my-qtip qtip-content="{{group.description}}">
                    {{group.description | addEllipsis}}
                </div>
            </td>
			<td>{{group.status}}</td>
		</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="5" class="text-center">
					<div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div>
				</td>
			</tr>
		</tfoot>
	  </table>
	</div>	
	
	<div ng-hide="createResolution || createRootCA">

	<form class="form-horizontal" ng-show="selectedGroup">
                  
         <div>
       		 <h2>Incident Group Detail</h2>
		 </div>
                  
         <div id="messages" class="alert alert-success" data-ng-show="messages" data-ng-bind="messages"></div>  
         <div id="messages" class="alert alert-danger" data-ng-show="errormessages" data-ng-bind="errormessages"></div>
         
		<div class="form-group">
     		<label class="col-sm-2 control-label">Name</label>
        	<div class="col-sm-7">
               <input type="text" class="form-control" ng-model="selectedGroup.name">
        	</div>
   		</div>
  
   		<div class="form-group">
     		<label class="col-sm-2 control-label">Description</label>
            <div class="col-sm-7">
                <textarea type="text"
                                  class="form-control"
                                  rows="5"
                                  ng-model="selectedGroup.description"></textarea>
            </div>
  		</div>
  
   		<div class="form-group">
     		<label class="col-sm-2 control-label">Status</label>
            <div class="col-sm-7">
                <select class="form-control" 
                        ng-model="selectedGroup.status" 
                        ng-options="c.name as c.name for c in statuss"></select>
            </div>
   		</div>

   		<div class="form-group">
             <div class="col-sm-offset-2 col-sm-10">
                   <button class="btn btn-primary" data-ng-disabled="disableButton" 
                        		data-ng-click="updateInGroupSearch()">
                            Save
                   </button>
                   <button class="btn btn-primary" data-ng-disabled="disableButton" 
                        		ng-click="showOnDelete('group')">
                        	Delete
                   </button>
                   <button class="btn btn-primary" data-ng-disabled="disableButton" 
                        		ng-click="createRes()">
                        	Create Resolution
                   </button>
                   <button class="btn btn-primary" data-ng-disabled="disableButton" 
                        		ng-click="createRCA()">
                        	Create RCA
                   </button> 
                   <button class="btn btn-primary"
                        		ng-click="cancel('group')">
                        	Back
                   </button>                           
             </div>
    	</div>
    	
    	<!-- The actual modal template, just a bit o bootstrap -->
        <script type="text/ng-template" id="modal.html">
         			<div class="modal fade">
          				<div class="modal-dialog">
            				<div class="modal-content">
              					<div class="modal-header">
                					<button type="button" class="close" ng-click="close('Cancel')" data-dismiss="modal" aria-hidden="true">&times;</button>
                					<h4 class="modal-title">Deletion confirmation:</h4>
             					</div>
              					<div class="modal-body">
               						<p>Are you sure you want to delete the group?</p>
             					</div>
              		 			<div class="modal-footer">
               			 			<button type="button" ng-click="close('No')" class="btn btn-default" data-dismiss="modal">No</button>
               			 			<button type="button" ng-click="close('Yes')" class="btn btn-primary" data-dismiss="modal">Yes</button>
              					</div>
           			 		</div>
          			 	</div>
        		     </div>
     	</script>

      </form>
      </div>
      
      <form class="form-horizontal" ng-show="createResolution">
      
         <div>
       		 <h2>Create Resolution</h2>
		 </div>
		 
		 <div id="messages" class="alert alert-success" data-ng-show="messages" data-ng-bind="messages"></div>  
         <div id="messages" class="alert alert-danger" data-ng-show="errormessages" data-ng-bind="errormessages"></div>
      
   		<div class="form-group">
      		<label class="control-label col-md-2">Incident Group Name</label>
       	    <div class="col-md-7 form-control-static">
          					  {{selectedGroup.name}}
       		</div>
  		</div>      
   
   		<div class="form-group">
       		<label class="col-sm-2 control-label">Horizon</label>
            <div class="col-sm-7">
                <select class="form-control" ng-model="selectedHorizon" ng-options="item.displayName for item in horizons">
   				</select>
            </div>
   		</div>

   		<div class="form-group">
     		<label class="col-sm-2 control-label">Owner</label>
        	<div class="col-sm-7">
               <input type="text" class="form-control" ng-model="selectedOwner">
        	</div>
  		</div>
   
   		<div class="form-group">
       		<label class="col-sm-2 control-label">Status</label>
            <div class="col-sm-7">
          		<select class="form-control" ng-model="selectedResStatus" ng-options="item.displayName for item in status">
   				</select>
          	</div>
   		 </div>
   
   		 <div class="form-group">
       		<label class="col-sm-2 control-label">Estimated Completion Date</label>
            <div class="col-sm-7">
               <input type="date" class="form-control" ng-model="selectedEstCompletionDate">
            </div>
   		</div>
   
   		<div class="form-group">
       		<label class="col-sm-2 control-label">Actual Completion Date</label>
            <div class="col-sm-7">
               <input type="date" class="form-control" ng-model="selectedActualCompletionDate">
            </div>
   		</div>
<!--    		
   		<div class="form-group">
			<label class="col-sm-2 control-label">Related Action's?</label>
			<div class="col-sm-7">

				<div class="panel-content">

					<div>

						<table class="table table-responsive" class="form-control">

							<tr ng-repeat="action in actions | filter:filterAction">
								<td class="editable-content table-responsive"><textarea
											type="text" class="form-control" rows="3" ng-model="action.name"></textarea></td>

								<td><button type="button" ng-click="deleteAction(action.id)"
										class="btn btn-primary pull-right form-control">Delete
										Action</button></td>
							</tr>
						</table>
						<button type="button" ng-disabled="tableform.$waiting"
							ng-click="addAction()" class="btn btn-primary ">Add Action</button>
						<br /> <br>
					</div>
				</div>
			</div>
		</div>
 -->
   		<div class="form-group">
       		<label class="col-sm-2 control-label">Type</label>
          	<div class="col-sm-7">
          		<select class="form-control" ng-model="selectedType" ng-options="item.displayName for item in types">
   				</select>
          </div>
    	</div>
   
   		<div class="form-group">
       		<label class="col-sm-2 control-label">SRI Artifact</label>
             <div class="col-sm-7">
                 <input type="text" class="form-control" ng-model="selectedSriArtifact">
             </div>
   		</div>
                
  		 <div class="form-group">
     		<label class="col-sm-2 control-label">Description</label>
            <div class="col-sm-7">
                <textarea type="text"
                                  class="form-control"
                                  rows="5"
                                  ng-model="selectedDescription"></textarea>
            </div>
   		</div>
   		
    	<div class="form-group">
             <div class="col-sm-offset-2 col-sm-10">
                   <button class="btn btn-primary" data-ng-disabled="progress.active()" 
                        		data-ng-click="submitRes()">
                            Submit
                   </button>
				   <button class="btn btn-primary" data-ng-disabled="progress.active()" 
                        		data-ng-click="cancel('resolution')">
                            Back
                   </button>
             </div>
     	</div>   
      
      </form>
      
      <form class="form-horizontal" ng-show="createRootCA">
      
         <div>
       		 <h2>Create RCA</h2>
		 </div>
		 
		 <div id="messages" class="alert alert-success" data-ng-show="messages" data-ng-bind="messages"></div>  
         <div id="messages" class="alert alert-danger" data-ng-show="errormessages" data-ng-bind="errormessages"></div>
      
   		<div class="form-group">
      		<label class="control-label col-md-2">Incident Group Name</label>
       	    <div class="col-md-7 form-control-static">
          					  {{selectedGroup.name}}
       		</div>
  		</div>      
   
      	<div class="form-group">
       		<label class="col-sm-2 control-label">Status</label>
              <div class="col-sm-7">
           		<select class="form-control" ng-model="selectedRCAStatus" ng-options="item.displayName for item in status">
   				</select>
          	  </div>
   		</div>

   		<div class="form-group">
     		<label class="col-sm-2 control-label">Owner</label>
        		<div class="col-sm-7">
              		 <input type="text" class="form-control" ng-model="selectedOwner">
        		</div>
   		</div>
   
   		<div class="form-group">
      		 <label class="col-sm-2 control-label">Problem Description</label>
               <div class="col-sm-7">
               	 <textarea type="text"
                                  class="form-control"
                                  rows="5"
                                  ng-model="selectedProblem"></textarea>
            	</div>
   		</div>
<!--              
      	<div class="form-group">
    		 <label class="col-sm-2 control-label">Why's?</label>
            	<div class="col-sm-7">
                	<textarea type="text"
                                  class="form-control"
                                  rows="5"
                                  ng-model="selectedWhys"></textarea>
            	</div>
   		</div>
-->    		
   		<div class="form-group">
			<label class="col-sm-2 control-label">Why's?</label>
			<div class="col-sm-7">
				<div class="panel-content">
					<div>
						<table class="table table-responsive" class="form-control">
							<tr ng-repeat="why in whys | filter:filterWhy">
									<td class=" editable-content table-responsive"><textarea
											type="text" class="form-control" rows="3" ng-model="why.name"></textarea></td>

								<td><button type="button" ng-click="deleteWhy(why.id)"
										class="btn btn-primary pull-right form-control">Delete
										Why</button></td>
							</tr>
						</table>
						<button type="button" ng-disabled="tableform.$waiting"
							ng-click="addWhy()" class="btn btn-primary ">Add Why</button>
						<br /> <br>
					</div>
				</div>
			</div>
		</div>
   
  		<div class="form-group">
       		<label class="col-sm-2 control-label">Due Date</label>
            	<div class="col-sm-7">
              		<input type="date" ng-model="selectedDueDate" class="form-control">
            	</div>
   		</div>
   
   		<div class="form-group">
       		<label class="col-sm-2 control-label">Completion Date</label>
            <div class="col-sm-7">
           	    <input type="date"  ng-model="selectedCompletionDate" class="form-control">
            </div>
   		</div>

   		<div class="form-group">
       		<label class="col-sm-2 control-label">Category</label>
          	<div class="col-sm-7">
          		<select class="form-control" ng-model="selectedCategory" ng-options="item.displayName for item in categories">
   				</select>
          	</div>
   		</div>
   
   		<div class="form-group">
       		 <label class="col-sm-2 control-label">Resource</label>
             <div class="col-sm-7">
               	<select class="form-control"  ng-model="selectedResource" ng-options="item.displayName for item in resources">
             	</select>
             </div>
   		</div>
   		
    	<div class="form-group">
             <div class="col-sm-offset-2 col-sm-10">
                   <button class="btn btn-primary" data-ng-disabled="progress.active()" 
                        		data-ng-click="submitRCA()">
                            Submit
                   </button>
				   <button class="btn btn-primary" data-ng-disabled="progress.active()" 
                        		data-ng-click="cancel('rca')">
                            Back
                   </button>
             </div>
     	</div>   
      
      </form>
	
</div>